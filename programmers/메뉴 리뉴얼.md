```javascript
function solution(orders, course) {
  let result = [];
  for (let length of course) {
    let menuMap = {};
    for (let order of orders) {
      let orderArr = order.split("").sort().join("");
      let combinations = generateCombinations(orderArr, length);
      for (let combination of combinations) {
        if (combination in menuMap) {
          menuMap[combination]++;
        } else {
          menuMap[combination] = 1;
        }
      }
    }
    let maxFrequency = 0;
    let maxMenus = [];
    for (let menu in menuMap) {
      if (menuMap[menu] >= 2 && menuMap[menu] > maxFrequency) {
        maxFrequency = menuMap[menu];
        maxMenus = [menu];
      } else if (menuMap[menu] >= 2 && menuMap[menu] === maxFrequency) {
        maxMenus.push(menu);
      }
    }
    result = result.concat(maxMenus);
  }
  return result.sort();
}

function generateCombinations(
  str,
  length,
  start = 0,
  current = "",
  result = []
) {
  if (current.length === length) {
    result.push(current);
    return result;
  }
  for (let i = start; i < str.length; i++) {
    generateCombinations(str, length, i + 1, current + str[i], result);
  }
  return result;
}
```
